# ğŸš¨ QA ê°ì‚¬ ë³´ê³ ì„œ: "ì´ ìƒíƒœë¡œ ë°°í¬í•˜ë©´ ì•ˆ ëœë‹¤"

**ë°œì‹ **: ì•…ë…í•œ QA íŒ€ì¥
**ëŒ€ìƒ**: importBack ê°œë°œíŒ€
**ì‹¬ê°ë„**: ğŸ”´ CRITICAL
**ì‘ì„±ì¼**: 2025-12-19
**ìƒíƒœ**: âš ï¸ Production Ready ì² íšŒ ê¶Œê³ 

---

## ğŸ“‹ Executive Summary

"ì™„ë£Œ ë³´ê³ ì„œ"ëŠ” **ê¸°ìˆ ì ìœ¼ë¡œëŠ” ì™„ë²½**í•˜ì§€ë§Œ, **ë¹„ì¦ˆë‹ˆìŠ¤ í˜„ì‹¤**ì„ ë¬´ì‹œí–ˆìŠµë‹ˆë‹¤.

| í•­ëª© | ë³´ê³ ì„œ ì£¼ì¥ | í˜„ì‹¤ | ìœ„í—˜ë„ |
|------|----------|------|--------|
| í‰ê·  ì‘ë‹µ | 500ms | ì²«ë‚  ëª¨ë‘ ë¯¸ìŠ¤ â†’ 6-8ì´ˆ | ğŸ”´ |
| ìºì‹œ íˆíŠ¸ìœ¨ | 70% | 0% ìŠ¤íƒ€íŠ¸ | ğŸ”´ |
| ë´‡ ì°¨ë‹¨ ëŒ€ì‘ | ì˜ˆì™¸ ì²˜ë¦¬ë¨ | IP ë°´ ë‹¹ì¼ ì „ë©¸ | ğŸ”´ |
| ë©”ëª¨ë¦¬ ì‚¬ìš© | 375MB | 4GB ì´ìƒ í•„ìš” | ğŸ”´ |
| Render ë¬´ë£Œ | ê°€ëŠ¥ | ë¶ˆê°€ëŠ¥ | ğŸ”´ |

**ê²°ë¡ **: "MVP for Internal Test" ë‹¨ê³„. í”„ë¡œë•ì…˜ì€ ì•„ì§ ì•„ë‹™ë‹ˆë‹¤.

---

## ğŸ¯ 5ê°€ì§€ ì¹˜ëª…ì  ê²°í•¨

### 1ï¸âƒ£ ì„±ëŠ¥ ì§€í‘œì˜ ê±°ì§“ë§ (The Throughput Lie)

#### ë³´ê³ ì„œì˜ ê±°ì§“
```
í‰ê·  ì‘ë‹µ ì‹œê°„: ~500ms (70% ìºì‹œ ê¸°ì¤€)
ë©”ëª¨ë¦¬ í•©ê³„: ~375MB
ì²˜ë¦¬ëŸ‰: 8-16 req/sec (4 ì›Œì»¤)
```

#### í˜„ì‹¤

**ì²«ë‚  ì‹œë‚˜ë¦¬ì˜¤ (ëª¨ë“  ìš”ì²­ì´ ìºì‹œ ë¯¸ìŠ¤)**:

```
ì‚¬ìš©ì: "ì•„ì´íŒ¨ë“œ í”„ë¡œ 11" ê²€ìƒ‰ (ì‹ ìƒí’ˆ, ìºì‹œ ì—†ìŒ)
â†“
FastPath 4ì´ˆ ë˜ëŠ” SlowPath 6.5ì´ˆ í•„ìš”
â†“
ë™ì‹œ ì‚¬ìš©ì 10ëª…ì´ ëª¨ë‘ ë¯¸ìŠ¤?

ê° SlowPath = Playwright ë¸Œë¼ìš°ì € 1ê°œ í•„ìš”
ë©”ëª¨ë¦¬: 200MB Ã— 10 = 2GB
CPU: 100% Ã— 10

ì„œë²„: t3.medium (ë©”ëª¨ë¦¬ 4GB)
ìƒí™©: OOM Kill ë°œìƒ. í”„ë¡œì„¸ìŠ¤ ì£½ìŒ.
ì‚¬ìš©ì 11ë²ˆì§¸: Connection Refused
```

**ì‹¤ì œ ì¸¡ì • í•„ìš”:**
```bash
# JMeter ì‹œë®¬ë ˆì´ì…˜
- ë™ì‹œ ì‚¬ìš©ì: 20ëª…
- ê°ê° ë‹¤ë¥¸ ê²€ìƒ‰ì–´ (ìºì‹œ ë¯¸ìŠ¤ 100%)
- ì§€ì† ì‹œê°„: 5ë¶„
- ê²°ê³¼: ????

ì˜ˆìƒ ì‹œë‚˜ë¦¬ì˜¤:
- ì²˜ìŒ 5ì´ˆ: ì„±ê³µ
- 5-15ì´ˆ: ì‘ë‹µ ì‹œê°„ 3ì´ˆ â†’ 8ì´ˆ â†’ 30ì´ˆ (íƒ€ì„ì•„ì›ƒ)
- 15ì´ˆ ì´í›„: Connection Refused ë˜ëŠ” 503 Unavailable
```

#### QA ê²€ì¦ ê³¼ì œ
- [ ] JMeterë¡œ ë™ì‹œ ì ‘ì† 20ëª…, ì „ë¶€ ìºì‹œ ë¯¸ìŠ¤ ìƒí™© í…ŒìŠ¤íŠ¸
- [ ] Playwright ë©”ëª¨ë¦¬ ì‹¤ì œ ì¸¡ì • (ë‹¨ì¼ vs ë‹¤ì¤‘ ì¸ìŠ¤í„´ìŠ¤)
- [ ] Gunicorn 4 ì›Œì»¤ ì„¤ì •ì—ì„œ ìµœëŒ€ ì•ˆì • ë™ì‹œ ì‚¬ìš©ì ì¸¡ì •
- [ ] ë©”ëª¨ë¦¬ ë¶€ì¡±(OOM) ë°œìƒ ì‹œ ì—ëŸ¬ ì‘ë‹µ vs ë¬´í•œ ëŒ€ê¸° í™•ì¸

---

### 2ï¸âƒ£ ë´‡ ì°¨ë‹¨ ì „ëµì˜ í•ì¤„ (The Blocking Disaster)

#### ë³´ê³ ì„œì˜ ì•ˆì¼í•¨
```python
# src/crawlers/fastpath_executor.py
try:
    response = await crawler.get_product_lowest_price(query)
except BlockedException:
    # SlowPathë¡œ í´ë°±
    logger.warning("Blocked by danawa, trying slowpath")
```

"í´ë°±í•˜ë©´ ëœë‹¤"? **í‹€ë ¸ìŠµë‹ˆë‹¤.**

#### í˜„ì‹¤

**ì‹œë‚˜ë¦¬ì˜¤ 1: IP ë°´**
```
ë°°í¬ 1ì‹œê°„ ë’¤
â”œâ”€ FastPath: 403 Forbidden (ë‹¤ë‚˜ì™€ IP ì°¨ë‹¨ ëª©ë¡ì— ë“±ì¬)
â”œâ”€ SlowPath: 503 Timeout (í”„ë¡ì‹œ ì—†ì´ ì§ì ‘ ì ‘ê·¼ = ì¦‰ì‹œ íƒì§€)
â””â”€ ê²°ê³¼: 100% ì‹¤íŒ¨ìœ¨

ì‚¬ìš©ìê°€ ë³´ëŠ” ê²ƒ:
"í˜„ì¬ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
(ì‹¤ì œ ì›ì¸: AWS IPëŠ” ì´ë¯¸ ë¸”ë™ë¦¬ìŠ¤íŠ¸)
```

**ì‹œë‚˜ë¦¬ì˜¤ 2: í”„ë¡œí† ì½œ íƒì§€**
```
ë‹¤ë‚˜ì™€ ì•ˆí‹°ë´‡ ì‹œìŠ¤í…œ:
- User-Agent ì²´í¬: âœ“ ìš°íšŒ ê°€ëŠ¥
- í—¤ë” ë¶„ì„: âœ“ ë³µì¡í•˜ì§€ë§Œ ìš°íšŒ ê°€ëŠ¥
- IP í‰íŒ: âœ— ë¶ˆê°€ëŠ¥ (ì¸í”„ë¼ ë³€ê²½ í•„ìš”)
- Playwright íƒì§€: âœ— Headless í”Œë˜ê·¸ ê°ì§€ (TLS ì§€ë¬¸ ë¶„ì„)

ê²°ê³¼: 
FastPath: User-Agent ë°”ê¾¸ë©´ ì¼ë¶€ ìš°íšŒ
SlowPath: Headless íƒì§€ â†’ ì°¨ë‹¨
```

**í”„ë¡œë•ì…˜ì— ë°°í¬í•˜ë©´?**
```
Day 1, 3ì‹œê°„ ë’¤:
- ë‹¤ë‚˜ì™€ ë³´ì•ˆíŒ€ì´ íŒ¨í„´ ë¶„ì„
- IP ì°¨ë‹¨ ëª©ë¡ ì—…ë°ì´íŠ¸
- FastPath 103 ì—ëŸ¬ (User-Agent ë³€ì¡° íƒì§€)

Day 1, 6ì‹œê°„ ë’¤:
- ê°œë°œíŒ€: "ì‘ë‹µ 400ê°œì¤‘ 380ê°œê°€ BlockedException"
- CTO: "ìš°ë¦¬ ë¹„ìš©ì€?"
- ìš´ì˜íŒ€: "IP ë°”ê¾¸ì„¸ìš”"
- ê°œë°œíŒ€: "ë­? ë‹¤ì‹œ ë°°í¬í•˜ê³ ?"
```

#### QA ê²€ì¦ ê³¼ì œ
- [ ] í”„ë¡œë•ì…˜ ë‹¤ë‚˜ì™€ ì ‘ì† ê·œì¹™ ì—­ë¶„ì„
  - [ ] IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸/ë¸”ë™ë¦¬ìŠ¤íŠ¸ ì •ì±… í™•ì¸
  - [ ] User-Agent í•„í„°ë§ ê·œì¹™ í™•ì¸
  - [ ] TLS ì§€ë¬¸ ë¶„ì„ ì—¬ë¶€ í™•ì¸
- [ ] Playwright íƒì§€ í…ŒìŠ¤íŠ¸
  ```bash
  # Playwright í—¤ë“œë¦¬ìŠ¤ê°€ íƒì§€ë˜ëŠ”ì§€ í™•ì¸
  curl -A "Mozilla/5.0 ..." https://danawa.com  # FastPath ëŒ€ì‹ 
  # vs
  playwright.chromium.launch(headless=False)  # ë³´ì´ëŠ” ëª¨ë“œ
  ```
- [ ] í”„ë¡ì‹œ ì„œë¹„ìŠ¤ í†µí•© í…ŒìŠ¤íŠ¸ (êµ¬í˜„ í•„ìš”)
- [ ] IP ì°¨ë‹¨ ì‹œ ìë™ í´ë°± ë¡œì§ (í˜„ì¬ ì—†ìŒ)

#### í•„ìˆ˜ êµ¬í˜„ (ì§€ê¸ˆ ë‹¹ì¥)
```python
# âŒ í˜„ì¬: ì˜ˆì™¸ë§Œ ì²˜ë¦¬
except BlockedException:
    return await slowpath_executor.search(query)

# âœ… í•„ìš”: í”„ë¡ì‹œ ë¡œí…Œì´ì…˜
class ProxyRotator:
    def __init__(self):
        self.proxies = [
            "socks5://proxy1.example.com:1080",
            "socks5://proxy2.example.com:1080",
            "http://proxy3.example.com:8080",
        ]
        self.current_index = 0
    
    def get_next_proxy(self):
        proxy = self.proxies[self.current_index % len(self.proxies)]
        self.current_index += 1
        return proxy

# âœ… í•„ìš”: IP ì°¨ë‹¨ ê°ì§€ ë° ì•Œë¦¼
if response.status_code == 403:
    AlertService.critical(
        subject="ë‹¤ë‚˜ì™€ IP ì°¨ë‹¨ ê°ì§€",
        details=f"IP {server_ip}ê°€ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ì¦‰ì‹œ ëŒ€ì‘ í•„ìš”"
    )
```

---

### 3ï¸âƒ£ ì •ê·œí™” í•¨ì • (The 'Apple' Trap)

#### ë³´ê³ ì„œì˜ ìì‹ ê°
```
ì…ë ¥:  "Apple 2025 ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 (M5 ëª¨ë¸)"
ì •ê·œí™”: "apple 2025 ipad pro 11 m5"
ë°œê²¬:  ë‹¤ë‚˜ì™€ì—ì„œ ì¼ì¹˜í•˜ëŠ” ì²« ë²ˆì§¸ ìƒí’ˆ
ê°€ê²©:  1,299,000ì›
```

**"ì¼ì¹˜í•˜ëŠ” ì²« ë²ˆì§¸"?** ì´ê²Œ ë¬¸ì œì…ë‹ˆë‹¤.

#### í˜„ì‹¤

**ì‹œë‚˜ë¦¬ì˜¤: ì˜µì…˜ ë¬´ì‹œ**
```
ì‚¬ìš©ì ì…ë ¥: 
  ìƒí’ˆëª…: "ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 (2025)"
  í˜„ì¬ê°€: 1,517,000ì› (256GB, WiFi+Cellular, Space Gray)

ì •ê·œí™” í›„ ë‹¤ë‚˜ì™€ ê²€ìƒ‰: 
  Query: "ipad pro 11 2025"

ë‹¤ë‚˜ì™€ ê²€ìƒ‰ ê²°ê³¼:
  1. "ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 2025 M5 64GB" - 899,000ì› â† ì‹œìŠ¤í…œì´ ì„ íƒ
  2. "ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 2025 M5 128GB" - 999,000ì›
  3. "ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 2025 M5 256GB WiFi" - 1,299,000ì›
  4. "ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 2025 M5 256GB WiFi+Cellular" - 1,699,000ì›

ì‹œìŠ¤í…œ ì‘ë‹µ:
{
  "lowest_price": 899000,
  "is_cheaper": true,
  "price_diff": 618000,
  "message": "ë¬´ë ¤ 618,000ì› ì €ë ´í•œ ê°€ê²© ë°œê²¬!"
}

ì‚¬ìš©ì: "ë­ì•¼ ì´ê±°? 64GBëŠ” ë‚´ê°€ ì•ˆ ì°¾ì€ ê±´ë°?"
ê³ ê° ë¶ˆë§Œ: â­â­ (5ì  ë§Œì )
```

**ë” ì‹¬í•œ ì¼€ì´ìŠ¤: í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ìƒí’ˆ**
```
ì‚¬ìš©ì ì…ë ¥:
  "Apple ì •í’ˆ ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 ì¼€ì´ìŠ¤"
  í˜„ì¬ê°€: 50,000ì›

ì •ê·œí™”:
  "apple ipad pro 11 case"

ë‹¤ë‚˜ì™€ ê²€ìƒ‰ ê²°ê³¼:
  1. "ARMOR-X ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 ì¼€ì´ìŠ¤" - 15,000ì› â† ì„ íƒë¨
  2. "ESR íœìŠ¬ í™€ë”" - 8,000ì›

ì‹œìŠ¤í…œ ì‘ë‹µ:
  "35,000ì› ì €ë ´í•œ Apple í˜¸í™˜ ì¼€ì´ìŠ¤ ë°œê²¬!"

ì‚¬ìš©ì: "ì´ê±´ ARMOR-Xì¸ë°? Apple ì •í’ˆì´ ì•„ë‹ˆì–ì•„?"
ë¸Œëœë“œ ì‹ ë¢°ë„: ë°•ì‚´
```

#### QA ê²€ì¦ ê³¼ì œ
- [ ] ìœ ì‚¬ ìƒí’ˆëª… êµ¬ë¶„ í…ŒìŠ¤íŠ¸ (ì„¸ë°€í•œ ì •ê·œí™” ê·œì¹™ í•„ìš”)
  ```python
  # í˜„ì¬: ë„ˆë¬´ ì¼ë°˜ì 
  normalize("Apple 2025 ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 M5 256GB")
  # ê²°ê³¼: "apple 2025 ipad pro 11 m5 256gb" â† ëª¨ë“  ë³€í˜•ì´ ê°™ìŒ
  
  # í•„ìš”: ì¹´í…Œê³ ë¦¬ë³„ ì •ê·œí™”
  normalize_product(
      name="Apple 2025 ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 M5 256GB",
      category="tablet",
      spec_weight=0.7,  # ìŠ¤í™ì´ ì¤‘ìš”í•¨
  )
  # ê²°ê³¼: 256GB ëª¨ë¸ë§Œ ë§¤ì¹­
  ```

- [ ] ë¸Œëœë“œ í•„í„°ë§
  ```python
  # "Apple ì •í’ˆ"ì´ ëª…ì‹œë˜ë©´
  search_results = [r for r in results if "ì •í’ˆ" in r.seller or "Apple" in r.brand]
  ```

- [ ] ê°€ê²© ë²”ìœ„ ê²€ì¦
  ```python
  # í˜„ì¬ ê°€ê²©ì´ 1,500,000ì›ì¸ë° ë°œê²¬ ê°€ê²©ì´ 100,000ì›?
  if abs(lowest_price - current_price) > current_price * 0.5:  # 50% ì´ìƒ ì°¨ì´
      logger.warning(f"Price mismatch detected. Likely wrong product.")
      raise PriceAnomaly(f"ê°€ê²© í¸ì°¨ê°€ {í¸ì°¨}% ì´ˆê³¼í•¨")
  ```

- [ ] ì‹¤ì œ ìƒí’ˆ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸
  - ì¼€ì´ìŠ¤: 64GB vs 128GB vs 256GB (ìµœì†Œ 10ê°œ ì‚¬ë¡€)
  - ì¼€ì´ìŠ¤: ì •í’ˆ vs í˜¸í™˜ ì œí’ˆ (ìµœì†Œ 10ê°œ ì‚¬ë¡€)
  - ì¼€ì´ìŠ¤: ìƒ‰ìƒ/ëª¨ë¸ ë³€í˜• (ìµœì†Œ 10ê°œ ì‚¬ë¡€)

---

### 4ï¸âƒ£ safe_* ë©”ì„œë“œì˜ ì—­ì„¤ (Quiet Failure Syndrome)

#### ë³´ê³ ì„œì˜ "ì•ˆì „í•¨"
```python
# src/utils/edge_cases.py
def safe_get(data: dict, key: str, expected_type: Optional[Type] = None, default=None):
    try:
        value = data.get(key)
        return value if value is not None else default
    except Exception:
        return default

def safe_int(value, min_val=None, max_val=None):
    try:
        return int(value)
    except (TypeError, ValueError):
        return None
```

"ì—ëŸ¬ê°€ ì—†ìœ¼ë‹ˆ ì•ˆì „í•˜ë‹¤"? **í‹€ë ¸ìŠµë‹ˆë‹¤. ë°ì´í„° ë¬´ê²°ì„±ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤.**

#### í˜„ì‹¤

**ì‹œë‚˜ë¦¬ì˜¤: ë‹¤ë‚˜ì™€ HTML êµ¬ì¡° ë³€ê²½**
```
ë‹¤ë‚˜ì™€ HTML ë³€ê²½:
Before: <span class="price_sect">1,299,000</span>
After:  <div class="product_price" data-price="1299000"></div>

FastPathExecutor:
```python
price_element = soup.select_one(".price_sect")  # â† ì°¾ì§€ ëª»í•¨ (None)
price_text = safe_get(price_element, "text")     # â† None ë°˜í™˜
price = safe_int(price_text)                      # â† None ë°˜í™˜
```

ê²°ê³¼:
- ì—ëŸ¬ ë¡œê·¸: âœ“ ê¹¨ë—í•¨ (ì˜ˆì™¸ ì—†ìŒ)
- ê°œë°œì ì•ŒëŒ: âœ— ì—†ìŒ (safe_*ê°€ ì¡°ìš©íˆ ì²˜ë¦¬)
- ì‚¬ìš©ìê°€ ë°›ëŠ” ì‘ë‹µ:
  ```json
  {
    "status": "error",
    "error_code": "PRODUCT_NOT_FOUND",
    "message": "ì…ë ¥í•˜ì‹  ìƒí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
  }
  ```
- ê°œë°œíŒ€ì´ ëª¨ë¥´ëŠ” ê²ƒ: ì‹¤ì œ ì›ì¸ì€ "íŒŒì‹± ì‹¤íŒ¨"ê°€ ì•„ë‹ˆë¼ "HTML êµ¬ì¡° ë³€ê²½"

24ì‹œê°„ ë’¤:
- CTO: "ì™œ ì„±ê³µë¥ ì´ ê°‘ìê¸° 30%ë¡œ ë–¨ì–´ì§„ ê±°ì•¼?"
- ê°œë°œíŒ€: "ë­? ë¡œê·¸ì— ì—ëŸ¬ê°€ ì—†ëŠ”ë°?"
- ìš´ì˜íŒ€: "ë‹¤ë‚˜ì™€ ì›¹ì‚¬ì´íŠ¸ ì—…ë°ì´íŠ¸ëœ ê²ƒ ê°™ì€ë°?"
- (24ì‹œê°„ ì†ì‹¤, ê³ ê° ë¶ˆë§Œ í­ì£¼)
```

#### QA ê²€ì¦ ê³¼ì œ
- [ ] **íŒŒì‹± ì‹¤íŒ¨ìœ¨ ëª¨ë‹ˆí„°ë§ í•„ìˆ˜ êµ¬í˜„**
  ```python
  # âŒ í˜„ì¬: ì¡°ìš©í•¨
  price = safe_int(price_text)  # Noneì´ë©´ ê·¸ëƒ¥ None
  
  # âœ… í•„ìš”: ë©”íŠ¸ë¦­ ìˆ˜ì§‘
  class ParsingMetrics:
      parsing_attempts = 0
      parsing_failures = 0
      
      def record_parse_attempt(self, source: str):
          self.parsing_attempts += 1
          
      def record_parse_failure(self, source: str, reason: str):
          self.parsing_failures += 1
          failure_rate = self.parsing_failures / self.parsing_attempts
          
          if failure_rate > 0.1:  # 10% ì´ìƒ ì‹¤íŒ¨
              AlertService.critical(
                  f"Parsing failure rate {failure_rate*100:.1f}% in {source}. "
                  f"Website structure may have changed."
              )
  ```

- [ ] **HTML ë³€ê²½ ê°ì§€ ì‹œìŠ¤í…œ**
  ```python
  # ë‹¤ë‚˜ì™€ HTMLì˜ "ì„ íƒì(selector)" ë²„ì „ ì¶”ì 
  SELECTORS_VERSION = 1  # 2024-12-19
  
  def fetch_with_selector_validation():
      response = await crawler.fetch(url)
      
      # êµ¬í˜• ì„ íƒìë¡œ í…ŒìŠ¤íŠ¸
      test_element = soup.select_one(".price_sect")
      
      if not test_element:
          # ì‹ ê·œ ì„ íƒìë¡œ ì¬ì‹œë„
          test_element = soup.select_one(".product_price")
          if test_element:
              AlertService.warning(
                  "Selector changed. Updating from .price_sect to .product_price"
              )
              SELECTORS_VERSION = 2
  ```

- [ ] **Daily Health Check**
  ```bash
  # ë§¤ì¼ ì˜¤ì „ 1ì‹œë§ˆë‹¤ ì‹¤í–‰
  0 1 * * * python scripts/daily_selector_check.py
  
  # ê²°ê³¼: 
  # "OK: ë‹¤ë‚˜ì™€ ì„ íƒì .price_sect ì •ìƒ ì‘ë™"
  # ë˜ëŠ”
  # "ALERT: ì„ íƒì ë³€ê²½ ê°ì§€. ì¦‰ì‹œ ì½”ë“œ ì—…ë°ì´íŠ¸ í•„ìš”"
  ```

---

### 5ï¸âƒ£ Render ë¬´ë£Œ ì„œë²„ì—ì„œ Playwright? ì•…ëª½ì…ë‹ˆë‹¤

#### ë³´ê³ ì„œì˜ ë¬´ì§€í•¨
```
ë©”ëª¨ë¦¬: ~375MB
Playwright: ~50MB
ê²°ë¡ : "ì¶©ë¶„í•¨"
```

**Render ë¬´ë£Œ í”Œëœì˜ í˜„ì‹¤ì„ ë³´ì„¸ìš”.**

#### Render ë¬´ë£Œ í”Œëœ ì‚¬ì–‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Render Free Tier Specifications     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CPU: 0.5 vCPU (ê³µìœ )                â”‚
â”‚ ë©”ëª¨ë¦¬: 512MB                       â”‚
â”‚ ìŠ¤í† ë¦¬ì§€: 0.5GB (Ephemeral)        â”‚
â”‚ ëŒ€ì—­í­: ì œí•œ ì—†ìŒ                   â”‚
â”‚ ì‹¤í–‰ ì‹œê°„: 15ë¶„ ìë™ ì¤‘ì§€           â”‚
â”‚ ì½œë“œ ìŠ¤íƒ€íŠ¸: 50-100ì´ˆ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Playwright í•„ìˆ˜ ìš”êµ¬ì‚¬í•­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Playwright Requirements             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë‹¨ì¼ ë¸Œë¼ìš°ì € ì¸ìŠ¤í„´ìŠ¤: 200-500MB   â”‚
â”‚ Chromium ë°”ì´ë„ˆë¦¬: 300MB            â”‚
â”‚ OS ë¼ì´ë¸ŒëŸ¬ë¦¬: ~100MB               â”‚
â”‚ Python ëŸ°íƒ€ì„: ~150MB               â”‚
â”‚ FastAPI ì„œë²„: ~100MB                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ í•©ê³„: ~1GB (ìµœì†Œ)                   â”‚
â”‚ Render ê°€ìš©: 512MB                  â”‚
â”‚ ë¶€ì¡±ë¶„: -488MB ğŸ˜±                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ì‹¤ì œ ë°°í¬ ì‹œë‚˜ë¦¬ì˜¤

**ì‹œê°„ 0ë¶„: ë°°í¬**
```
1. Renderì— í‘¸ì‹œ
2. ë¹Œë“œ ì‹œì‘
3. Playwright ë‹¤ìš´ë¡œë“œ ì‹œì‘
   â””â”€ Chromium: 300MB ë‹¤ìš´
   â””â”€ í˜ì´ì§€ ë¡œë“œ... í˜ì´ì§€ ë¡œë“œ...
4. ë©”ëª¨ë¦¬ ë¶€ì¡± â†’ OOM Kill
5. ë¹Œë“œ ì‹¤íŒ¨
```

**í•´ê²°ì±… ì‹œë„ 1: ë¬¸ì œ ë¬´ì‹œ**
```
ê°œë°œì: "Playwright ì—†ì´ FastPathë§Œ ì“°ë©´ ë˜ì§€"
ê²°ê³¼: SlowPath ì™„ì „ ë¶ˆê°€ëŠ¥ â†’ ë‹¤ë‚˜ì™€ IP ì°¨ë‹¨ ì‹œ 100% ì‹¤íŒ¨
```

**í•´ê²°ì±… ì‹œë„ 2: ë¬´ë£Œ Chromium ë¼ì´ë¸ŒëŸ¬ë¦¬**
```bash
# âŒ Chrome ì—†ì´ ì‹¤í–‰?
playwright install-deps
# ì˜¤ë¥˜: Could not find compatible Chromium
```

**í•´ê²°ì±… ì‹œë„ 3: ì™¸ë¶€ Playwright ì„œë¹„ìŠ¤**
```python
# Browserless.io ê°™ì€ ì„œë¹„ìŠ¤ ì‚¬ìš©
async def search_with_external_playwright(query):
    async with aiohttp.ClientSession() as session:
        response = await session.post(
            "https://api.browserless.io/chromium/execute?token=...",
            json={"code": "..."}
        )
```

**ë¬¸ì œ**: 
- ì›” ë¹„ìš©: $50/month (ë¬´ë£Œ Renderì€ $0)
- íŠ¸ë˜í”½ì— ë”°ë¼ ë¹„ìš© ê¸‰ì¦
- ë ˆì´í„´ì‹œ: ë¡œì»¬ vs ì™¸ë¶€ ì„œë¹„ìŠ¤ = 2ë°° ëŠë¦¼

#### QA ê²€ì¦ ê³¼ì œ

**ì„ íƒì§€ ë¶„ì„**:

| ë°°í¬ ë°©ì‹ | ë©”ëª¨ë¦¬ | Playwright | ë¹„ìš© | ê°€ëŠ¥ì„± |
|---------|--------|-----------|------|--------|
| **Render Free** | 512MB | âŒ ë¶ˆê°€ëŠ¥ | $0 | ğŸ’€ |
| **Render Paid** | 512MB+ | âœ“ ê°€ëŠ¥ | $7-24/ì›” | âš ï¸ |
| **Heroku** | 512MB | âŒ ì°¨ë‹¨ë¨ | $7+/ì›” | ğŸ’€ |
| **Railway** | 512MB | âŒ ë¶ˆê°€ëŠ¥ | $5+/ì›” | ğŸ’€ |
| **AWS Lightsail** | 512MB | âš ï¸ 2-3ê°œ | $3.5/ì›” | âœ“ |
| **DigitalOcean App** | 512MB | âŒ ë¶ˆê°€ëŠ¥ | $12+/ì›” | ğŸ’€ |
| **Browserless.io** | N/A | âœ“ ê´€ë¦¬ë¨ | $50+/ì›” | âœ“ ë¹„ìŒˆ |

- [ ] **í˜„ì‹¤ì ì¸ ë°°í¬ í”Œëœ ìˆ˜ë¦½**
  - FastPathë§Œ ì‚¬ìš©? (SlowPath ì™„ì „ ì œê±°)
  - Playwright ì™¸ë¶€ ì„œë¹„ìŠ¤? (Browserless.io)
  - ë” ë¹„ì‹¼ ì„œë²„ ì‚¬ìš©? (Render Paid)

- [ ] **ë¹„ìš© vs ì„±ëŠ¥ ì‹œë®¬ë ˆì´ì…˜**
  ```python
  # ë¹„ìš© ê³„ì‚°
  fastpath_only = {
      "server": "$0 (Render Free)",
      "ì„±ê³µë¥ ": "60% (IP ì°¨ë‹¨ ì‹œ 0%)",
      "ì›”ë¹„ìš©": "$0",
      "ë¬¸ì œ": "ë‹¤ë‚˜ì™€ ì°¨ë‹¨ ì‹œ ì„œë¹„ìŠ¤ ì¤‘ë‹¨"
  }
  
  fastpath_slowpath_external = {
      "server": "$12 (Render Paid)",
      "ì„±ê³µë¥ ": "95% (Browserless.io ì•ˆì •)",
      "ì›”ë¹„ìš©": "$12 + $50 (Browserless) = $62",
      "ë¬¸ì œ": "ë¹„ìš© ì¦ê°€"
  }
  ```

---

## ğŸ›¡ï¸ í•„ìˆ˜ ê²€ì¦ í…ŒìŠ¤íŠ¸ 3ê°€ì§€

ê°œë°œíŒ€ì´ "Product"ë¼ê³  ìš°ê¸°ê¸° ì „ì— **ì´ 3ê°€ì§€ëŠ” ë°˜ë“œì‹œ** í†µê³¼í•˜ì„¸ìš”.

### Test 1: The "Kill Switch" Test

**ëª©í‘œ**: Graceful Degradation í™•ì¸

```python
# ì‹œë®¬ë ˆì´ì…˜: ëª¨ë“  ë‹¤ë‚˜ì™€ ì ‘ì† ì°¨ë‹¨
import socket

# hosts íŒŒì¼ ìˆ˜ì • ë˜ëŠ” mockìœ¼ë¡œ
# 127.0.0.1 search.danawa.com
# 127.0.0.1 prod.danawa.com

# API ìš”ì²­
response = client.post(
    "/api/v1/price/search",
    json={"product_name": "ì•„ì´íŒ¨ë“œ", "current_price": 1500000}
)

# ì˜ˆìƒ:
assert response.status_code == 503
assert response.json()["error_code"] == "SERVICE_UNAVAILABLE"

# í˜„ì‹¤ì´ ë  ìˆ˜ ìˆëŠ” ê²ƒ:
# - ë¬´í•œ ë¡œë”© (íƒ€ì„ì•„ì›ƒ ì—†ì´)
# - 500 Internal Error (ì˜ˆì™¸ ì²˜ë¦¬ ì•ˆ ë¨)
# - ì´ìƒí•œ ì—ëŸ¬ ë©”ì‹œì§€
```

**í‰ê°€ ê¸°ì¤€**:
- âœ“ ì¦‰ì‹œ 503 ì‘ë‹µ (10ì´ˆ ë‚´)
- âœ“ ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€
- âœ— ë¬´í•œ ëŒ€ê¸°
- âœ— 500 ì—ëŸ¬

### Test 2: The "Wrong Product" Test

**ëª©í‘œ**: ì˜¤íƒ(False Positive) ê°ì§€

```python
# ì¼€ì´ìŠ¤ 1: ìš©ëŸ‰ì´ ë‹¤ë¥¸ ìƒí’ˆ
request = {
    "product_name": "ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 256GB",
    "current_price": 1500000,
}

response = client.post("/api/v1/price/search", json=request)

# Mock ë‹¤ë‚˜ì™€ ì‘ë‹µ: 64GB ëª¨ë¸ (ê°€ê²©: 800,000ì›)
# 
# ì˜ˆìƒ: 
# âœ“ ê²½ê³ : "ì œí’ˆ ìŠ¤í™ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤"
# âœ— ì‹œìŠ¤í…œ: "700,000ì› ì €ë ´!" (ì˜ëª»ëœ ì •ë³´)

# ì¼€ì´ìŠ¤ 2: í˜¸í™˜ ì œí’ˆ (ì¼€ì´ìŠ¤)
request = {
    "product_name": "Apple ì •í’ˆ ì•„ì´íŒ¨ë“œ í”„ë¡œ 11 ì¼€ì´ìŠ¤",
    "current_price": 50000,
}

response = client.post("/api/v1/price/search", json=request)

# ì˜ˆìƒ: 
# âœ“ "ì •í’ˆ" í•„í„°ë§ ì ìš©
# âœ— ì €ê°€ í˜¸í™˜ ì¼€ì´ìŠ¤ì™€ í˜¼ë™
```

**í‰ê°€ ê¸°ì¤€**:
- âœ“ ìŠ¤í™ ê²€ì¦ ë¡œì§ ìˆìŒ
- âœ“ ë¸Œëœë“œ í•„í„°ë§ ìˆìŒ
- âœ“ ê°€ê²© í¸ì°¨ > 50%ì¼ ë•Œ ê²½ê³ 
- âœ— ëª¨ë“  ê²°ê³¼ë¥¼ êµ¬ë¶„ ì—†ì´ ë°˜í™˜

### Test 3: The "Flood" Test

**ëª©í‘œ**: ë™ì‹œ ì ‘ì† ì„±ëŠ¥ ì¸¡ì •

```bash
# Locust ìŠ¤í¬ë¦½íŠ¸
from locust import HttpUser, task, between

class ImportBackUser(HttpUser):
    wait_time = between(1, 3)
    
    @task
    def search_product(self):
        # ìºì‹œ ë¯¸ìŠ¤ë¥¼ ê°•ì œí•˜ê¸° ìœ„í•´ ë§¤ë²ˆ ë‹¤ë¥¸ ìƒí’ˆ ê²€ìƒ‰
        import uuid
        product = f"í…ŒìŠ¤íŠ¸ìƒí’ˆ_{uuid.uuid4()}"
        
        self.client.post(
            "/api/v1/price/search",
            json={
                "product_name": product,
                "current_price": random.randint(10000, 5000000)
            }
        )

# ì‹¤í–‰
locust -f locustfile.py -u 20 -r 5 -t 300s
```

**ê²°ê³¼ ë¶„ì„**:

| ì§€í‘œ | ê¸°ì¤€ | í‰ê°€ |
|------|------|------|
| í‰ê·  ì‘ë‹µ | < 3ì´ˆ | âš ï¸ í•©ê²© |
| P95 ì‘ë‹µ | < 5ì´ˆ | âš ï¸ í•©ê²© |
| ì‹¤íŒ¨ìœ¨ | < 5% | âš ï¸ í•©ê²© |
| ë©”ëª¨ë¦¬ ì•ˆì • | < ë©”ëª¨ë¦¬ í•œê³„ 70% | âœ“ í•„ìˆ˜ |
| CPU ì•ˆì • | < 80% | âœ“ í•„ìˆ˜ |

---

## ğŸ“Š í˜„ì‹¤ì ì¸ ë¹„ìš© ë¶„ì„

### ì‹œë‚˜ë¦¬ì˜¤ 1: Render ë¬´ë£Œ (í˜„ì¬ ê³„íš)

```
ë°°í¬ ê²°ê³¼:
âœ“ Playwright ì•ˆ ëŒì•„ê°
âœ“ FastPathë§Œ ì‘ë™
âœ“ ë¹„ìš©: $0

í˜„ì‹¤:
âŒ IP ì°¨ë‹¨ ì‹œ 100% ì‹¤íŒ¨
âŒ SlowPath ë¶ˆê°€ëŠ¥
âŒ ê³ ê° ì´íƒˆ
```

**ë¹„ìš© = $0 + ê³ ê° ì†ì‹¤ = âˆ**

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: Render Paid Tier

```
ë°°í¬ êµ¬ì„±:
- Render Pro: $24/ì›” (512MB ë©”ëª¨ë¦¬)
- ë¬¸ì œ: PlaywrightëŠ” ì—¬ì „íˆ 600MB í•„ìš” â†’ OOM

í•´ê²°ì±…:
- Render Pro: $70+/ì›” (2GB ë©”ëª¨ë¦¬)

ë˜ëŠ” ì™¸ë¶€ Playwright:
- Browserless.io: $50/ì›” (250 ë¸Œë¼ìš°ì € ì„¸ì…˜/ì›”)

ì´ ë¹„ìš©: $70-120/ì›”
```

**ê³„ì‚°**:
```
ì›” ì‚¬ìš©ì: 1,000ëª…
ì›” ê²€ìƒ‰: 5,000íšŒ (í‰ê·  5íšŒ/ëª…)

Renderë§Œ: 
  - ë©”ëª¨ë¦¬: 2GB = $70/ì›”
  - ì„±ê³µë¥ : 80% (IP ì°¨ë‹¨ ë•Œë¬¸ì—)
  - ê³ ê° ë§Œì¡±: â­â­â­

Render + Browserless:
  - ë©”ëª¨ë¦¬: 512MB = $24/ì›”
  - Browserless: $50/ì›”
  - ì´: $74/ì›”
  - ì„±ê³µë¥ : 95% (FastPath + SlowPath ëª¨ë‘ ì‘ë™)
  - ê³ ê° ë§Œì¡±: â­â­â­â­â­

ê²°ë¡ : ì°¨ì´ $4/ì›”, ì„±ê³µë¥  ì°¨ì´ 15% â†’ Browserless ì¶”ì²œ
```

---

## ğŸ”´ ìµœì¢… ê²°ë¡ 

| í•­ëª© | ìƒíƒœ | ì¡°ì¹˜ |
|------|------|------|
| MyPy íƒ€ì… ì²´í¬ | âœ… ì™„ë£Œ | - |
| ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ | âœ… ì™„ë£Œ | - |
| **ì„±ëŠ¥ ë¶€í•˜ í…ŒìŠ¤íŠ¸** | âŒ ë¯¸ì™„ | JMeter í•„ìˆ˜ |
| **ë´‡ ì°¨ë‹¨ ëŒ€ì‘** | âŒ ë¯¸ì™„ | í”„ë¡ì‹œ ë¡œí…Œì´ì…˜ í•„ìˆ˜ |
| **ì •ê·œí™” ê²€ì¦** | âŒ ë¯¸ì™„ | ìŠ¤í™ ë§¤ì¹­ ë¡œì§ ì¶”ê°€ |
| **íŒŒì‹± ì‹¤íŒ¨ ê°ì‹œ** | âŒ ë¯¸ì™„ | ë©”íŠ¸ë¦­ ìˆ˜ì§‘ í•„ìˆ˜ |
| **ë°°í¬ í”Œëœ** | âŒ ë¯¸ì™„ | Render ìœ ë£Œ ë˜ëŠ” Browserless |

---

## âœ… í•´ì•¼ í•  ì¼ (ìš°ì„ ìˆœìœ„)

### ğŸ”´ Critical (ì´ë²ˆ ì£¼)
1. [ ] JMeter ë¶€í•˜ í…ŒìŠ¤íŠ¸ - 20ë™ì‹œ ì‚¬ìš©ì, ìºì‹œ ë¯¸ìŠ¤ 100%
2. [ ] Playwright ë©”ëª¨ë¦¬ í”„ë¡œíŒŒì¼ë§ - ì‹¤ì œ ì‚¬ìš© ì¸¡ì •
3. [ ] íŒŒì‹± ì‹¤íŒ¨ìœ¨ ëª¨ë‹ˆí„°ë§ êµ¬í˜„

### ğŸŸ  High (2ì£¼)
4. [ ] í”„ë¡ì‹œ ë¡œí…Œì´ì…˜ ì‹œìŠ¤í…œ êµ¬í˜„
5. [ ] ìŠ¤í™ ë§¤ì¹­ ë¡œì§ ì¶”ê°€ (256GB vs 64GB êµ¬ë¶„)
6. [ ] ë°°í¬ í”Œëœ ì¬ì •ë¦½ (Render Paid vs Browserless)

### ğŸŸ¡ Medium (3ì£¼)
7. [ ] HTML ì„ íƒì ë³€ê²½ ê°ì§€ ì‹œìŠ¤í…œ
8. [ ] Daily Health Check êµ¬í˜„
9. [ ] IP ì°¨ë‹¨ ê°ì§€ ë° ì•Œë¦¼

---

## ğŸ¯ í•©ê²©ì„ 

"Production Ready"ë¼ê³  ì¸ì •í•˜ë ¤ë©´:

- [x] MyPy strict: 0 ì—ëŸ¬
- [x] í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€: 85%
- [ ] **ë¶€í•˜ í…ŒìŠ¤íŠ¸ í†µê³¼: 20ë™ì‹œ ì‚¬ìš©ì, 2ë¶„ê°„ 95% ì„±ê³µ**
- [ ] **ë´‡ ì°¨ë‹¨ ëŒ€ì‘: í”„ë¡ì‹œ ë¡œí…Œì´ì…˜ ë˜ëŠ” ì™¸ë¶€ ì„œë¹„ìŠ¤**
- [ ] **ì •ê·œí™” ê²€ì¦: ìƒí’ˆ ìŠ¤í™ í•„í„°ë§**
- [ ] **ë°°í¬ ë¹„ìš© ê³„ì‚°: ì›”ë³„ ì˜ˆìƒ ì§€ì¶œ**
- [ ] **3ê°€ì§€ ê²€ì¦ í…ŒìŠ¤íŠ¸: Kill Switch, Wrong Product, Flood**

---

**ìƒíƒœ**: âš ï¸ MVP for Internal Test Only

**ë‹¤ìŒ íšŒì˜**: 2025-12-22 (ë¶€í•˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ê³µìœ )

**ì„œëª…**: ì•…ë…í•œ QA íŒ€ì¥
